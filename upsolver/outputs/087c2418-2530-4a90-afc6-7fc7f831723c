{
  "clazz" : "OutputTemplate",
  "useNewEscaping" : false,
  "supportMapSameKeyMultipleTimes" : false,
  "id" : "087c2418-2530-4a90-afc6-7fc7f831723c",
  "displayData" : {
    "name" : "mq_an_cash_purchase_v2",
    "description" : "Duplicate of mq_an_cash_purchase",
    "creationTime" : "2021-04-26T22:24:25.568889Z",
    "createdBy" : "Roby Jacob (roby.jacob@hashcube.com)",
    "modifiedTime" : "2021-04-28T07:03:42.583981Z",
    "modifiedBy" : {
      "value" : "Roby Jacob (roby.jacob@hashcube.com)"
    },
    "versionId" : "8d214657-52dd-4cf9-b630-c1b9a67a7643"
  },
  "inputs" : [ "05ade5d7-702e-48b6-bba4-e6aa83131320" ],
  "organizationId" : "33b7cf17-9f45-4e72-824d-10bd03e88dde",
  "groupBy" : false,
  "computeEnvironment" : "e3758dc9-1775-4904-9704-29afbbbc0885",
  "outputParameters" : {
    "clazz" : "CompositeHiveMetastoreOutputParameters",
    "outputFields" : [ {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "IS_DUPLICATE('d6b0c7d1-eafc-44d0-a5de-326b6acde669', 14400000, data.receipt:string)",
        "field" : {
          "name" : "duplicate_receipt",
          "nativeType" : {
            "name" : "boolean",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "data.receipt",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        } ],
        "feature" : {
          "clazz" : "IsDuplicateFeature$IsDuplicateString",
          "dedupId" : "d6b0c7d1-eafc-44d0-a5de-326b6acde669",
          "windowSize" : 14400000
        },
        "filterParameters" : {
          "enabled" : false,
          "inverted" : false
        },
        "inline" : false,
        "id" : "a4298cde-0272-6715-9325-48c4f50ec7de",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "UNIX_EPOCH_TO_DATE(time:number)",
        "field" : {
          "name" : "partition_date",
          "nativeType" : {
            "name" : "instant",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "time",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        } ],
        "feature" : {
          "clazz" : "NumericFeatures$EpochMillisToInstant"
        },
        "inline" : false,
        "id" : "cf8aeba6-fcd9-b0e4-e46f-ae8b164096e5",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "UNIX_EPOCH_TO_DATE(data.date_time:number)",
        "field" : {
          "name" : "date_time",
          "nativeType" : {
            "name" : "instant",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "data.date_time",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        } ],
        "feature" : {
          "clazz" : "NumericFeatures$EpochMillisToInstant"
        },
        "inline" : false,
        "id" : "e65cb9a0-5d83-48b6-8a75-15676b036ab5",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "PYTHON('UDF Deleted ðŸ˜”', data.uid:string)",
        "field" : {
          "name" : "new_transaction_count",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "data.uid",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        } ],
        "feature" : {
          "clazz" : "UserDefinedFunctionFeature",
          "id" : "e9e4b0d6-74d5-4065-95d8-48206f82b057",
          "returnType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          },
          "arguments" : [ {
            "name" : "uid",
            "typeName" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          } ]
        },
        "inline" : false,
        "id" : "f3833825-c16d-4671-b37d-1a1e4d6f5b98",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : null,
        "field" : {
          "name" : "kl",
          "nativeType" : {
            "name" : "lookup_371fa4d1-82b9-4646-a5aa-658c3ee7bde9",
            "isArray" : false,
            "subFields" : [ {
              "name" : "uid",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "network_name",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "site_id",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "campaign_id",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "campaign_name",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            } ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "data.uid",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        }, {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "time",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        } ],
        "feature" : {
          "clazz" : "TemplateLookupFeature",
          "indexId" : "371fa4d1-82b9-4646-a5aa-658c3ee7bde9",
          "aggregations" : [ {
            "clazz" : "NewIndexAggregation",
            "name" : "uid",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.uid",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : true,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "network_name",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.network_name",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "site_id",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.site_id",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "campaign_id",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.campaign_id",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "campaign_name",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.campaign_name",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          } ],
          "timeOffset" : 0,
          "useLatestSnapshot" : true,
          "innerJoin" : false,
          "useMutatedIndex" : false,
          "minTime" : "2021-04-27T03:46:02.919440Z"
        },
        "inline" : true,
        "id" : "40fdc94d-5d26-45f8-aaa6-bf17a08b6db0",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : null,
        "field" : {
          "name" : "dl",
          "nativeType" : {
            "name" : "lookup_dda3a5fe-b710-4371-8f75-b5ea4e0b557d",
            "isArray" : false,
            "subFields" : [ {
              "name" : "uid",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "variant",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "start_time",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "device_id",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "device_name",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "kochava_id",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "install_time",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "ip_address",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "installed_version",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "current_version",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "current_design_version",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "last_update",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "platform",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            } ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "data.uid",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        }, {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "time",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        } ],
        "feature" : {
          "clazz" : "TemplateLookupFeature",
          "indexId" : "dda3a5fe-b710-4371-8f75-b5ea4e0b557d",
          "aggregations" : [ {
            "clazz" : "NewIndexAggregation",
            "name" : "uid",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.uid",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : true,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "variant",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.variant",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "start_time",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.start_time",
                "nativeType" : {
                  "name" : "number",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "device_id",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.device_id",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "device_name",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.device_name",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "kochava_id",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.kochava_id",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "install_time",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.install_time",
                "nativeType" : {
                  "name" : "number",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "ip_address",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.ip_address",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "installed_version",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.installed_version",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "current_version",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.current_version",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "current_design_version",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.current_design_version",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "last_update",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.last_update",
                "nativeType" : {
                  "name" : "number",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "platform",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "PointerFeatureInput",
              "featureId" : "d782ea6a-d52e-c3fa-661d-0e59eab961ba",
              "subField" : "",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "platform",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          } ],
          "timeOffset" : 0,
          "useLatestSnapshot" : true,
          "innerJoin" : false,
          "useMutatedIndex" : false,
          "minTime" : "2021-04-27T03:46:02.919440Z"
        },
        "inline" : true,
        "id" : "55b11c0b-9cc1-4719-a6e4-77769a02b2a0",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : null,
        "field" : {
          "name" : "transaction_lookup",
          "nativeType" : {
            "name" : "lookup_57335712-e498-497b-8a30-5457745e01d8",
            "isArray" : false,
            "subFields" : [ {
              "name" : "uid",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "total_transactions",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              }
            } ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "data.uid",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        }, {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "time",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        } ],
        "feature" : {
          "clazz" : "TemplateLookupFeature",
          "indexId" : "57335712-e498-497b-8a30-5457745e01d8",
          "aggregations" : [ {
            "clazz" : "NewIndexAggregation",
            "name" : "uid",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.uid",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : true,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "total_transactions",
            "operation" : {
              "clazz" : "AggregationType$CountAll2"
            },
            "inputFields" : [ ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          } ],
          "timeOffset" : 0,
          "useLatestSnapshot" : false,
          "innerJoin" : false,
          "useMutatedIndex" : false
        },
        "inline" : true,
        "id" : "dced1695-04cd-4708-9f67-50e37faa0479",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : null,
        "field" : {
          "name" : "currency_rates",
          "nativeType" : {
            "name" : "lookup",
            "isArray" : false,
            "subFields" : [ {
              "name" : "currency",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "rates",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              }
            } ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "data.local_currency",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        } ],
        "feature" : {
          "clazz" : "ReferenceDataFeatureV2",
          "referenceDataId" : "69ac34e2-8888-4fbd-b032-ad129b5422c6",
          "keyFields" : [ {
            "name" : "currency",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          } ],
          "valueFields" : [ {
            "name" : "currency",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "name" : "rates",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          } ],
          "refreshIntervalSeconds" : 0
        },
        "inline" : true,
        "id" : "66e9ad98-a4c7-4ca8-898f-9c4f027e23f7",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ {
        "name" : "transaction_number",
        "index" : 23,
        "outputType" : {
          "name" : "long",
          "isArray" : false,
          "subFields" : [ ]
        },
        "warnings" : [ ]
      } ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "COALESCE(transaction_lookup.total_transactions, 0) + new_transaction_count",
        "field" : {
          "name" : "transaction_number",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "InlineFeatureInput",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          },
          "dsl" : "COALESCE(transaction_lookup.total_transactions, 0)",
          "feature" : {
            "clazz" : "NumericFeatures$CoalesceFeature"
          },
          "featureInputs" : [ {
            "clazz" : "PointerFeatureInput",
            "featureId" : "dced1695-04cd-4708-9f67-50e37faa0479",
            "subField" : "total_transactions",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            },
            "field" : {
              "name" : "transaction_lookup.total_transactions",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              }
            },
            "isAggregationField" : false
          }, {
            "clazz" : "LiteralFeatureInput",
            "literal" : 0,
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          } ],
          "infix" : false
        }, {
          "clazz" : "PointerFeatureInput",
          "featureId" : "f3833825-c16d-4671-b37d-1a1e4d6f5b98",
          "subField" : "",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "new_transaction_count",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false
        } ],
        "feature" : {
          "clazz" : "SimpleNumericFeatures$AddFeature"
        },
        "inline" : false,
        "id" : "054a9638-02aa-48c6-a066-e24f0acee009",
        "infix" : true,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ {
        "name" : "start_time",
        "index" : 20,
        "warnings" : [ ]
      } ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "UNIX_EPOCH_TO_DATE(dl.start_time)",
        "field" : {
          "name" : "start_time",
          "nativeType" : {
            "name" : "instant",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "PointerFeatureInput",
          "featureId" : "55b11c0b-9cc1-4719-a6e4-77769a02b2a0",
          "subField" : "start_time",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "dl.start_time",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false
        } ],
        "feature" : {
          "clazz" : "NumericFeatures$EpochMillisToInstant"
        },
        "inline" : false,
        "id" : "cb330ab3-4b5c-4414-b503-2133d6baac28",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ {
        "name" : "network_name",
        "index" : 10,
        "warnings" : [ ]
      } ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "IF_ELSE(kl.network_name = '', 'Organic', kl.network_name)",
        "field" : {
          "name" : "network_name",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "InlineFeatureInput",
          "nativeType" : {
            "name" : "boolean",
            "isArray" : false,
            "subFields" : [ ]
          },
          "dsl" : "kl.network_name = ''",
          "feature" : {
            "clazz" : "AnyFeatures$EqualToFilterV2"
          },
          "featureInputs" : [ {
            "clazz" : "PointerFeatureInput",
            "featureId" : "40fdc94d-5d26-45f8-aaa6-bf17a08b6db0",
            "subField" : "network_name",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            },
            "field" : {
              "name" : "kl.network_name",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            },
            "isAggregationField" : false
          }, {
            "clazz" : "LiteralFeatureInput",
            "literal" : "",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          } ],
          "infix" : true
        }, {
          "clazz" : "LiteralFeatureInput",
          "literal" : "Organic",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        }, {
          "clazz" : "PointerFeatureInput",
          "featureId" : "40fdc94d-5d26-45f8-aaa6-bf17a08b6db0",
          "subField" : "network_name",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "kl.network_name",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false
        } ],
        "feature" : {
          "clazz" : "StringFeatures$IfElseV2"
        },
        "inline" : false,
        "id" : "a6230842-09d3-493b-9b23-ae90942c6df7",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "CONCAT(',', SPLIT('(', kl.site_id))",
        "field" : {
          "name" : "siteid_parsed_str",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "InlineFeatureInput",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "dsl" : "SPLIT('(', kl.site_id)",
          "feature" : {
            "clazz" : "StringFeatures$SplitFeature",
            "splitBy" : "("
          },
          "featureInputs" : [ {
            "clazz" : "PointerFeatureInput",
            "featureId" : "40fdc94d-5d26-45f8-aaa6-bf17a08b6db0",
            "subField" : "site_id",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            },
            "field" : {
              "name" : "kl.site_id",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            },
            "isAggregationField" : false
          } ],
          "infix" : false
        } ],
        "feature" : {
          "clazz" : "ArrayJoin",
          "separator" : ","
        },
        "inline" : false,
        "id" : "999f7e6f-9153-4bf4-bdb1-a1981700e861",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ {
        "name" : "placement_name",
        "index" : 16,
        "warnings" : [ ]
      } ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "IF_ELSE(CONTAINS(kl.site_id, 'mobileapp::'), kl.site_id, '')",
        "field" : {
          "name" : "placement_name",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "InlineFeatureInput",
          "nativeType" : {
            "name" : "boolean",
            "isArray" : false,
            "subFields" : [ ]
          },
          "dsl" : "CONTAINS(kl.site_id, 'mobileapp::')",
          "feature" : {
            "clazz" : "StringFeatures$ContainsFilter"
          },
          "featureInputs" : [ {
            "clazz" : "PointerFeatureInput",
            "featureId" : "40fdc94d-5d26-45f8-aaa6-bf17a08b6db0",
            "subField" : "site_id",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            },
            "field" : {
              "name" : "kl.site_id",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            },
            "isAggregationField" : false
          }, {
            "clazz" : "LiteralFeatureInput",
            "literal" : "mobileapp::",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          } ],
          "infix" : false
        }, {
          "clazz" : "PointerFeatureInput",
          "featureId" : "40fdc94d-5d26-45f8-aaa6-bf17a08b6db0",
          "subField" : "site_id",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "kl.site_id",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false
        }, {
          "clazz" : "LiteralFeatureInput",
          "literal" : "",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        } ],
        "feature" : {
          "clazz" : "StringFeatures$IfElseV2"
        },
        "inline" : false,
        "id" : "d628398b-f72d-4774-a786-d6dc63c19152",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ {
        "name" : "usd_amount",
        "index" : 5,
        "outputType" : {
          "name" : "double",
          "isArray" : false,
          "subFields" : [ ]
        },
        "warnings" : [ ]
      } ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "data.local_amount:number / (currency_rates.rates * 0.83)",
        "field" : {
          "name" : "amount",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "data.local_amount",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        }, {
          "clazz" : "InlineFeatureInput",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          },
          "dsl" : "currency_rates.rates * 0.83",
          "feature" : {
            "clazz" : "SimpleNumericFeatures$MultiplyFeature"
          },
          "featureInputs" : [ {
            "clazz" : "PointerFeatureInput",
            "featureId" : "66e9ad98-a4c7-4ca8-898f-9c4f027e23f7",
            "subField" : "rates",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            },
            "field" : {
              "name" : "currency_rates.rates",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              }
            },
            "isAggregationField" : false
          }, {
            "clazz" : "LiteralFeatureInput",
            "literal" : 0.83,
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          } ],
          "infix" : true
        } ],
        "feature" : {
          "clazz" : "SimpleNumericFeatures$DivideFeature"
        },
        "inline" : false,
        "id" : "be95f63d-385a-4f77-96a2-dbb8cca31728",
        "infix" : true,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : null,
        "field" : {
          "name" : "purchase_validate",
          "nativeType" : {
            "name" : "lookup_b1083626-03d1-4875-a891-6d70682de9ce",
            "isArray" : false,
            "subFields" : [ {
              "name" : "uid",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "date_time",
              "nativeType" : {
                "name" : "instant",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "not_fake",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              }
            } ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "data.uid",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        }, {
          "clazz" : "PointerFeatureInput",
          "featureId" : "e65cb9a0-5d83-48b6-8a75-15676b036ab5",
          "subField" : "",
          "nativeType" : {
            "name" : "instant",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "date_time",
            "nativeType" : {
              "name" : "instant",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false
        }, {
          "clazz" : "FieldFeatureInput",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "time",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false,
          "isFromInline" : false
        } ],
        "feature" : {
          "clazz" : "TemplateLookupFeature",
          "indexId" : "b1083626-03d1-4875-a891-6d70682de9ce",
          "aggregations" : [ {
            "clazz" : "NewIndexAggregation",
            "name" : "uid",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.uid",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : true,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "date_time",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "PointerFeatureInput",
              "featureId" : "d67d7f5b-11ec-7fdc-5030-1efdbf71d495",
              "subField" : "",
              "nativeType" : {
                "name" : "instant",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "date_time",
                "nativeType" : {
                  "name" : "instant",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : true,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "instant",
              "isArray" : false,
              "subFields" : [ ]
            }
          }, {
            "clazz" : "NewIndexAggregation",
            "name" : "not_fake",
            "operation" : {
              "clazz" : "AggregationType$Last"
            },
            "inputFields" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.not_fake",
                "nativeType" : {
                  "name" : "number",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            } ],
            "expirationWindow" : 14400000,
            "isKeyColumn" : false,
            "withBitmaps" : false,
            "maximumExpirationWindow" : 14400000,
            "returnType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          } ],
          "timeOffset" : 0,
          "useLatestSnapshot" : true,
          "innerJoin" : false,
          "useMutatedIndex" : false,
          "minTime" : "2021-04-27T03:46:02.919440Z"
        },
        "inline" : true,
        "id" : "689fb32a-f161-4ac9-8f67-cbaf8db521ba",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "SPLIT_TO_RECORD('campaign_name,adgroup_name,adgroup_id', ',', true, siteid_parsed_str)",
        "field" : {
          "name" : "adinfo",
          "nativeType" : {
            "name" : "split_to_record_campaign_name,adgroup_name,adgroup_id",
            "isArray" : false,
            "subFields" : [ {
              "name" : "campaign_name",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "adgroup_name",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            }, {
              "name" : "adgroup_id",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            } ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "PointerFeatureInput",
          "featureId" : "999f7e6f-9153-4bf4-bdb1-a1981700e861",
          "subField" : "",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "siteid_parsed_str",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false
        } ],
        "feature" : {
          "clazz" : "StringFeatures$SplitToRecordFeature",
          "fieldNames" : "campaign_name,adgroup_name,adgroup_id",
          "splitBy" : ",",
          "filterEmptyValues" : true
        },
        "inline" : false,
        "id" : "9cfc9caa-90b6-4874-9a64-c69dc564dfc4",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "IF_ELSE(purchase_validate.not_fake = 0, true, false)",
        "field" : {
          "name" : "is_fake",
          "nativeType" : {
            "name" : "boolean",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "InlineFeatureInput",
          "nativeType" : {
            "name" : "boolean",
            "isArray" : false,
            "subFields" : [ ]
          },
          "dsl" : "purchase_validate.not_fake = 0",
          "feature" : {
            "clazz" : "AnyFeatures$EqualToFilterV2"
          },
          "featureInputs" : [ {
            "clazz" : "PointerFeatureInput",
            "featureId" : "689fb32a-f161-4ac9-8f67-cbaf8db521ba",
            "subField" : "not_fake",
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            },
            "field" : {
              "name" : "purchase_validate.not_fake",
              "nativeType" : {
                "name" : "number",
                "isArray" : false,
                "subFields" : [ ]
              }
            },
            "isAggregationField" : false
          }, {
            "clazz" : "LiteralFeatureInput",
            "literal" : 0,
            "nativeType" : {
              "name" : "number",
              "isArray" : false,
              "subFields" : [ ]
            }
          } ],
          "infix" : true
        }, {
          "clazz" : "LiteralFeatureInput",
          "literal" : true,
          "nativeType" : {
            "name" : "boolean",
            "isArray" : false,
            "subFields" : [ ]
          }
        }, {
          "clazz" : "LiteralFeatureInput",
          "literal" : false,
          "nativeType" : {
            "name" : "boolean",
            "isArray" : false,
            "subFields" : [ ]
          }
        } ],
        "feature" : {
          "clazz" : "StringFeatures$IfElseV2"
        },
        "filterParameters" : {
          "enabled" : false,
          "inverted" : false
        },
        "inline" : false,
        "id" : "4701c476-89c5-4a64-a759-d35f272878e1",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ {
        "name" : "adgroup_name",
        "index" : 14,
        "warnings" : [ ]
      } ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "STRIP_SUFFIX(')', adinfo.adgroup_name)",
        "field" : {
          "name" : "adgroup_name_parsed",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "PointerFeatureInput",
          "featureId" : "9cfc9caa-90b6-4874-9a64-c69dc564dfc4",
          "subField" : "adgroup_name",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "adinfo.adgroup_name",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false
        } ],
        "feature" : {
          "clazz" : "StringFeatures$StripSuffixFeature",
          "suffix" : ")"
        },
        "inline" : false,
        "id" : "a141a353-75aa-4b8f-a084-3c51a883cb9f",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ {
        "name" : "adgroup_id",
        "index" : 15,
        "warnings" : [ ]
      } ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "STRIP_SUFFIX(')', adinfo.adgroup_id)",
        "field" : {
          "name" : "adgroup_id_parsed",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "PointerFeatureInput",
          "featureId" : "9cfc9caa-90b6-4874-9a64-c69dc564dfc4",
          "subField" : "adgroup_id",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          },
          "field" : {
            "name" : "adinfo.adgroup_id",
            "nativeType" : {
              "name" : "string",
              "isArray" : false,
              "subFields" : [ ]
            }
          },
          "isAggregationField" : false
        } ],
        "feature" : {
          "clazz" : "StringFeatures$StripSuffixFeature",
          "suffix" : ")"
        },
        "inline" : false,
        "id" : "6573e66d-4c8e-46a5-aab8-50eb97ba803a",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "IF_ELSE(CONTAINS(data.receipt:string, 'noreceipt') AND is_fake, false, true)",
        "field" : {
          "name" : "noreceipt_fake",
          "nativeType" : {
            "name" : "boolean",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "InlineFeatureInput",
          "nativeType" : {
            "name" : "boolean",
            "isArray" : false,
            "subFields" : [ ]
          },
          "dsl" : "CONTAINS(data.receipt:string, 'noreceipt') AND is_fake",
          "feature" : {
            "clazz" : "BooleanFeatures$AndFilterV3"
          },
          "featureInputs" : [ {
            "clazz" : "InlineFeatureInput",
            "nativeType" : {
              "name" : "boolean",
              "isArray" : false,
              "subFields" : [ ]
            },
            "dsl" : "CONTAINS(data.receipt:string, 'noreceipt')",
            "feature" : {
              "clazz" : "StringFeatures$ContainsFilter"
            },
            "featureInputs" : [ {
              "clazz" : "FieldFeatureInput",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              },
              "field" : {
                "name" : "data.receipt",
                "nativeType" : {
                  "name" : "string",
                  "isArray" : false,
                  "subFields" : [ ]
                }
              },
              "isAggregationField" : false,
              "isFromInline" : false
            }, {
              "clazz" : "LiteralFeatureInput",
              "literal" : "noreceipt",
              "nativeType" : {
                "name" : "string",
                "isArray" : false,
                "subFields" : [ ]
              }
            } ],
            "infix" : false
          }, {
            "clazz" : "PointerFeatureInput",
            "featureId" : "4701c476-89c5-4a64-a759-d35f272878e1",
            "subField" : "",
            "nativeType" : {
              "name" : "boolean",
              "isArray" : false,
              "subFields" : [ ]
            },
            "field" : {
              "name" : "is_fake",
              "nativeType" : {
                "name" : "boolean",
                "isArray" : false,
                "subFields" : [ ]
              }
            },
            "isAggregationField" : false
          } ],
          "infix" : true
        }, {
          "clazz" : "LiteralFeatureInput",
          "literal" : false,
          "nativeType" : {
            "name" : "boolean",
            "isArray" : false,
            "subFields" : [ ]
          }
        }, {
          "clazz" : "LiteralFeatureInput",
          "literal" : true,
          "nativeType" : {
            "name" : "boolean",
            "isArray" : false,
            "subFields" : [ ]
          }
        } ],
        "feature" : {
          "clazz" : "StringFeatures$IfElseV2"
        },
        "filterParameters" : {
          "enabled" : false,
          "inverted" : false
        },
        "inline" : false,
        "id" : "fab1049c-777f-455b-9498-35b2f7b01619",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "RawCalculatedFieldOutput",
      "outputs" : [ {
        "name" : "fake",
        "index" : 24,
        "outputType" : {
          "name" : "long",
          "isArray" : false,
          "subFields" : [ ]
        },
        "warnings" : [ ]
      } ],
      "featureDefinition" : {
        "clazz" : "FeatureDefinition",
        "dsl" : "IF_ELSE(((duplicate_receipt AND NOT(CONTAINS(data.receipt:string, 'noreceipt'))) AND NOT(is_fake)) OR noreceipt_fake, 1, 0)",
        "field" : {
          "name" : "fake",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "featureInputs" : [ {
          "clazz" : "InlineFeatureInput",
          "nativeType" : {
            "name" : "boolean",
            "isArray" : false,
            "subFields" : [ ]
          },
          "dsl" : "((duplicate_receipt AND NOT(CONTAINS(data.receipt:string, 'noreceipt'))) AND NOT(is_fake)) OR noreceipt_fake",
          "feature" : {
            "clazz" : "BooleanFeatures$OrFilterV3"
          },
          "featureInputs" : [ {
            "clazz" : "InlineFeatureInput",
            "nativeType" : {
              "name" : "boolean",
              "isArray" : false,
              "subFields" : [ ]
            },
            "dsl" : "(duplicate_receipt AND NOT(CONTAINS(data.receipt:string, 'noreceipt'))) AND NOT(is_fake)",
            "feature" : {
              "clazz" : "BooleanFeatures$AndFilterV3"
            },
            "featureInputs" : [ {
              "clazz" : "InlineFeatureInput",
              "nativeType" : {
                "name" : "boolean",
                "isArray" : false,
                "subFields" : [ ]
              },
              "dsl" : "duplicate_receipt AND NOT(CONTAINS(data.receipt:string, 'noreceipt'))",
              "feature" : {
                "clazz" : "BooleanFeatures$AndFilterV3"
              },
              "featureInputs" : [ {
                "clazz" : "PointerFeatureInput",
                "featureId" : "a4298cde-0272-6715-9325-48c4f50ec7de",
                "subField" : "",
                "nativeType" : {
                  "name" : "boolean",
                  "isArray" : false,
                  "subFields" : [ ]
                },
                "field" : {
                  "name" : "duplicate_receipt",
                  "nativeType" : {
                    "name" : "boolean",
                    "isArray" : false,
                    "subFields" : [ ]
                  }
                },
                "isAggregationField" : false
              }, {
                "clazz" : "InlineFeatureInput",
                "nativeType" : {
                  "name" : "boolean",
                  "isArray" : false,
                  "subFields" : [ ]
                },
                "dsl" : "NOT(CONTAINS(data.receipt:string, 'noreceipt'))",
                "feature" : {
                  "clazz" : "BooleanFeatures$NotFilterV2"
                },
                "featureInputs" : [ {
                  "clazz" : "InlineFeatureInput",
                  "nativeType" : {
                    "name" : "boolean",
                    "isArray" : false,
                    "subFields" : [ ]
                  },
                  "dsl" : "CONTAINS(data.receipt:string, 'noreceipt')",
                  "feature" : {
                    "clazz" : "StringFeatures$ContainsFilter"
                  },
                  "featureInputs" : [ {
                    "clazz" : "FieldFeatureInput",
                    "nativeType" : {
                      "name" : "string",
                      "isArray" : false,
                      "subFields" : [ ]
                    },
                    "field" : {
                      "name" : "data.receipt",
                      "nativeType" : {
                        "name" : "string",
                        "isArray" : false,
                        "subFields" : [ ]
                      }
                    },
                    "isAggregationField" : false,
                    "isFromInline" : false
                  }, {
                    "clazz" : "LiteralFeatureInput",
                    "literal" : "noreceipt",
                    "nativeType" : {
                      "name" : "string",
                      "isArray" : false,
                      "subFields" : [ ]
                    }
                  } ],
                  "infix" : false
                } ],
                "infix" : true
              } ],
              "infix" : true
            }, {
              "clazz" : "InlineFeatureInput",
              "nativeType" : {
                "name" : "boolean",
                "isArray" : false,
                "subFields" : [ ]
              },
              "dsl" : "NOT(is_fake)",
              "feature" : {
                "clazz" : "BooleanFeatures$NotFilterV2"
              },
              "featureInputs" : [ {
                "clazz" : "PointerFeatureInput",
                "featureId" : "4701c476-89c5-4a64-a759-d35f272878e1",
                "subField" : "",
                "nativeType" : {
                  "name" : "boolean",
                  "isArray" : false,
                  "subFields" : [ ]
                },
                "field" : {
                  "name" : "is_fake",
                  "nativeType" : {
                    "name" : "boolean",
                    "isArray" : false,
                    "subFields" : [ ]
                  }
                },
                "isAggregationField" : false
              } ],
              "infix" : true
            } ],
            "infix" : true
          }, {
            "clazz" : "PointerFeatureInput",
            "featureId" : "fab1049c-777f-455b-9498-35b2f7b01619",
            "subField" : "",
            "nativeType" : {
              "name" : "boolean",
              "isArray" : false,
              "subFields" : [ ]
            },
            "field" : {
              "name" : "noreceipt_fake",
              "nativeType" : {
                "name" : "boolean",
                "isArray" : false,
                "subFields" : [ ]
              }
            },
            "isAggregationField" : false
          } ],
          "infix" : true
        }, {
          "clazz" : "LiteralFeatureInput",
          "literal" : 1,
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          }
        }, {
          "clazz" : "LiteralFeatureInput",
          "literal" : 0,
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          }
        } ],
        "feature" : {
          "clazz" : "StringFeatures$IfElseV2"
        },
        "inline" : false,
        "id" : "765a491c-99eb-490d-9288-401149a11342",
        "infix" : false,
        "blockId" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
        "pathForRead" : { }
      }
    }, {
      "clazz" : "UpsertKeyOutput",
      "field" : {
        "clazz" : "PointerFeatureInput",
        "featureId" : "e65cb9a0-5d83-48b6-8a75-15676b036ab5",
        "subField" : "",
        "nativeType" : {
          "name" : "instant",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "date_time",
          "nativeType" : {
            "name" : "instant",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false
      },
      "isAggregated" : false,
      "outputs" : [ {
        "name" : "payment_time",
        "index" : 1,
        "warnings" : [ ]
      } ]
    }, {
      "clazz" : "UpsertKeyOutput",
      "field" : {
        "clazz" : "FieldFeatureInput",
        "nativeType" : {
          "name" : "string",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "data.uid",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false,
        "isFromInline" : false
      },
      "isAggregated" : false,
      "outputs" : [ {
        "name" : "uid",
        "index" : 0,
        "warnings" : [ ]
      } ]
    }, {
      "clazz" : "PartitionTimeOutput",
      "field" : {
        "clazz" : "PointerFeatureInput",
        "featureId" : "cf8aeba6-fcd9-b0e4-e46f-ae8b164096e5",
        "subField" : "",
        "nativeType" : {
          "name" : "instant",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "partition_date",
          "nativeType" : {
            "name" : "instant",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false
      },
      "isAggregated" : false,
      "outputs" : [ {
        "name" : "partition_date",
        "index" : 2,
        "warnings" : [ ]
      } ]
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "currency_bundle",
        "index" : 3,
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "FieldFeatureInput",
        "nativeType" : {
          "name" : "string",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "data.currency_bundle",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false,
        "isFromInline" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "local_amount",
        "index" : 4,
        "outputType" : {
          "name" : "double",
          "isArray" : false,
          "subFields" : [ ]
        },
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "FieldFeatureInput",
        "nativeType" : {
          "name" : "number",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "data.local_amount",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false,
        "isFromInline" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "local_currency",
        "index" : 6,
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "FieldFeatureInput",
        "nativeType" : {
          "name" : "string",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "data.local_currency",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false,
        "isFromInline" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "ms_no",
        "index" : 7,
        "outputType" : {
          "name" : "long",
          "isArray" : false,
          "subFields" : [ ]
        },
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "FieldFeatureInput",
        "nativeType" : {
          "name" : "number",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "data.ms",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false,
        "isFromInline" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "sale_id",
        "index" : 8,
        "outputType" : {
          "name" : "long",
          "isArray" : false,
          "subFields" : [ ]
        },
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "FieldFeatureInput",
        "nativeType" : {
          "name" : "number",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "data.sale_id",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false,
        "isFromInline" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "source",
        "index" : 9,
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "FieldFeatureInput",
        "nativeType" : {
          "name" : "string",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "data.source",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false,
        "isFromInline" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "site_id",
        "index" : 11,
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "PointerFeatureInput",
        "featureId" : "40fdc94d-5d26-45f8-aaa6-bf17a08b6db0",
        "subField" : "site_id",
        "nativeType" : {
          "name" : "string",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "kl.site_id",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "campaign_id",
        "index" : 12,
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "PointerFeatureInput",
        "featureId" : "40fdc94d-5d26-45f8-aaa6-bf17a08b6db0",
        "subField" : "campaign_id",
        "nativeType" : {
          "name" : "string",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "kl.campaign_id",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "campaign_name",
        "index" : 13,
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "PointerFeatureInput",
        "featureId" : "40fdc94d-5d26-45f8-aaa6-bf17a08b6db0",
        "subField" : "campaign_name",
        "nativeType" : {
          "name" : "string",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "kl.campaign_name",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "variant",
        "index" : 17,
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "PointerFeatureInput",
        "featureId" : "55b11c0b-9cc1-4719-a6e4-77769a02b2a0",
        "subField" : "variant",
        "nativeType" : {
          "name" : "string",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "dl.variant",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "installed_version",
        "index" : 18,
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "PointerFeatureInput",
        "featureId" : "55b11c0b-9cc1-4719-a6e4-77769a02b2a0",
        "subField" : "installed_version",
        "nativeType" : {
          "name" : "string",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "dl.installed_version",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "current_version",
        "index" : 19,
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "PointerFeatureInput",
        "featureId" : "55b11c0b-9cc1-4719-a6e4-77769a02b2a0",
        "subField" : "current_version",
        "nativeType" : {
          "name" : "string",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "dl.current_version",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "platform",
        "index" : 21,
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "PointerFeatureInput",
        "featureId" : "55b11c0b-9cc1-4719-a6e4-77769a02b2a0",
        "subField" : "platform",
        "nativeType" : {
          "name" : "string",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "dl.platform",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "event_time",
        "index" : 22,
        "outputType" : {
          "name" : "long",
          "isArray" : false,
          "subFields" : [ ]
        },
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "FieldFeatureInput",
        "nativeType" : {
          "name" : "number",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "time",
          "nativeType" : {
            "name" : "number",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false,
        "isFromInline" : false
      }
    }, {
      "clazz" : "RawOutput",
      "outputs" : [ {
        "name" : "receipt",
        "index" : 25,
        "warnings" : [ ]
      } ],
      "field" : {
        "clazz" : "FieldFeatureInput",
        "nativeType" : {
          "name" : "string",
          "isArray" : false,
          "subFields" : [ ]
        },
        "field" : {
          "name" : "data.receipt",
          "nativeType" : {
            "name" : "string",
            "isArray" : false,
            "subFields" : [ ]
          }
        },
        "isAggregationField" : false,
        "isFromInline" : false
      }
    } ],
    "softRetention" : false,
    "partitionSize" : "Daily",
    "path" : "",
    "compression" : {
      "clazz" : "SnappyCompression",
      "extension" : "snappy",
      "headerOffset" : 0,
      "displayName" : "Snappy"
    },
    "mandatory" : {
      "clazz" : "CompositeHiveMetastoreMandatory",
      "s3Connection" : "9a50b066-44ab-4fb3-bdb2-e21636425647",
      "hiveMetastores" : [ {
        "clazz" : "AthenaMetastoreArgs",
        "connection" : "d083bc39-f592-444f-9217-c173df5ee609",
        "databaseName" : "upsolverdb",
        "tableName" : "mq_an_cash_purchase_v2"
      } ]
    },
    "compactionParallelism" : {
      "clazz" : "NoOperationParallelism"
    },
    "selectedOutputType" : "AthenaMetastoreArgs",
    "runCompactions" : true,
    "scheduledCompactions" : {
      "compactions" : [ ]
    },
    "upsertPartitionFields" : false,
    "shouldFlatten" : true,
    "allowNotPartitionedTable" : false
  },
  "outputInterval" : 1,
  "startExecutionFrom" : "2021-04-25T19:42:13.287005Z",
  "allowCartesianProducts" : false,
  "isDeleted" : false,
  "isRunning" : true,
  "deployedEver" : true,
  "connectionPointer" : "9a50b066-44ab-4fb3-bdb2-e21636425647",
  "physicalDelete" : {
    "initiated" : true,
    "shouldRun" : true
  },
  "version" : 59,
  "allowRenaming" : true,
  "operationParallelism" : {
    "clazz" : "NoOperationParallelism"
  },
  "outputSharding" : {
    "clazz" : "NoOperationParallelism"
  },
  "earliestStartExecutionFrom" : "2021-04-25T19:42:13.287005Z",
  "executionState" : {
    "clazz" : "ExecutionState$Running"
  },
  "workspaces" : [ ],
  "reportingTags" : "",
  "blocks" : [ {
    "id" : "b2433553-bd3d-4e2e-a753-e05f9b286f28",
    "title" : "Select Block",
    "expression" : "SET duplicate_receipt = IS_DUPLICATE('d6b0c7d1-eafc-44d0-a5de-326b6acde669', 14400000, data.receipt);\nSET transaction_number = COALESCE(transaction_lookup.total_transactions, 0) + new_transaction_count;\nSET partition_date = UNIX_EPOCH_TO_DATE(time);\nSET date_time = UNIX_EPOCH_TO_DATE(data.date_time);\nSET start_time = UNIX_EPOCH_TO_DATE(dl.start_time);\nSET network_name = IF_ELSE(kl.network_name = '', 'Organic', kl.network_name);\nSET siteid_parsed_str = CONCAT(',', SPLIT('(', kl.site_id));\nSET placement_name = IF_ELSE(CONTAINS(kl.site_id, 'mobileapp::'), kl.site_id, '');\nSET adinfo = SPLIT_TO_RECORD('campaign_name,adgroup_name,adgroup_id', ',', true, siteid_parsed_str);\nSET adgroup_name_parsed = STRIP_SUFFIX(')', adinfo.adgroup_name);\nSET adgroup_id_parsed = STRIP_SUFFIX(')', adinfo.adgroup_id);\nSET amount = data.local_amount / (currency_rates.rates * 0.83);\nSET new_transaction_count = PYTHON('get_count', data.uid);\nSET is_fake = IF_ELSE(purchase_validate.not_fake = 0, true, false);\nSET noreceipt_fake = IF_ELSE(CONTAINS(data.receipt, 'noreceipt') AND is_fake, false, true);\nset fake = IF_ELSE((duplicate_receipt AND NOT(CONTAINS(data.receipt, 'noreceipt')) AND NOT(is_fake)) OR noreceipt_fake, 1, 0);\n\nSELECT data.uid AS uid,\n       date_time AS payment_time,\n       PARTITION_TIME(partition_date) AS partition_date,\n       data.currency_bundle AS currency_bundle,\n       data.local_amount AS local_amount:DOUBLE,\n       amount AS usd_amount:DOUBLE,\n       data.local_currency AS local_currency,\n       data.ms AS ms_no:BIGINT,\n       data.sale_id AS sale_id:BIGINT,\n       data.source AS source,\n       network_name AS network_name,\n       kl.site_id AS site_id,\n       kl.campaign_id AS campaign_id,\n       kl.campaign_name AS campaign_name,\n       adgroup_name_parsed AS adgroup_name,\n       adgroup_id_parsed AS adgroup_id,\n       placement_name AS placement_name,\n       dl.variant AS variant,\n       dl.installed_version AS installed_version,\n       dl.current_version AS current_version,\n       start_time AS start_time,\n       dl.platform AS platform,\n       time AS event_time:BIGINT,\n       transaction_number AS transaction_number:BIGINT,\n       fake AS fake:BIGINT,\n       data.receipt AS receipt\n  FROM mq_cash_purchase_v2 \n  LEFT JOIN LATEST mq_device_kochava_lookup kl ON kl.uid = data.uid\n  LEFT JOIN LATEST mq_device_lookup dl ON dl.uid = data.uid\n  LEFT JOIN mq_transaction_count_lookup transaction_lookup ON transaction_lookup.uid = data.uid\n  LEFT JOIN currency_rates currency_rates ON currency_rates.currency = data.local_currency\n  LEFT JOIN LATEST mq_purchase_validate_lookup purchase_validate ON purchase_validate.uid = data.uid\n     AND purchase_validate.date_time = date_time \n    REPLACE ON DUPLICATE date_time, data.uid\n",
    "dslWarnings" : [ ],
    "isSelectBlock" : true
  } ],
  "groupByDeletion" : true,
  "eventTypes" : [ ],
  "inputInterval" : 1,
  "restrictions" : [ ],
  "status" : {
    "clazz" : "Deleting"
  },
  "shards" : 1,
  "outputShards" : 1,
  "hasAggregations" : false,
  "allReferences" : [ "371fa4d1-82b9-4646-a5aa-658c3ee7bde9", "dda3a5fe-b710-4371-8f75-b5ea4e0b557d", "57335712-e498-497b-8a30-5457745e01d8", "b1083626-03d1-4875-a891-6d70682de9ce", "05ade5d7-702e-48b6-bba4-e6aa83131320" ],
  "versionNumber" : 1
}